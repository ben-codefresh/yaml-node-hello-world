version: '1.0'

steps:
  build-step:
    type: build
    description: It builds the Djanga Service
    dockerfile: Dockerfile
    image-name: codefreshio/bamigrash
  
  unit test with composition with file generation:
    type: composition
    composition: 
      service1:
        volumes:
          - ${{CF_VOLUME}}:/codefresh/volume
        image: ${{build-step}}
        command: bash -c "/codefresh/volume/myfile.txt"
    composition-candidates:
      test:
        image: ${{build-step}}
        command: echo hello
  
  use previous file:
    image: alpine:latest
    working-directory: ${{initial-clone}}
    commands:
      - echo using previous file. printing its content
      - cat /codefresh/volume/myfile.txt